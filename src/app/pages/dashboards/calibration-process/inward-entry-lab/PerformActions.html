// // condition according button


import React, { useState, useRef, useEffect } from 'react';
import PropTypes from 'prop-types';

// Ensure location is available (e.g., with React Router or window object)
const searchParams = typeof window !== 'undefined' ? new URLSearchParams(window.location.search) : new URLSearchParams();
const calibacc = searchParams.get('calibacc') || '';
console.log(calibacc);

const userId = typeof window !== 'undefined' ? localStorage.getItem('userId') : null;
console.log('Logged in user id:', userId);

// Simple icons as SVG components
const EllipsisHorizontalIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
    </svg>
);

const DocumentArrowUpIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
    </svg>
);

const DocumentTextIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 11.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
);

const PlusIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
    </svg>
);

const DocumentDuplicateIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
    </svg>
);

const PencilIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
    </svg>
);

const XMarkIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
    </svg>
);

const ExclamationTriangleIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.764 0L3.034 16.5c-.77.833.192 2.5 1.732 2.5z" />
    </svg>
);

const ArrowPathIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m-4.991 0v4.994" />
    </svg>
);

const WrenchScrewdriverIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z" />
    </svg>
);

const ArrowLeftIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
    </svg>
);

const Cog6ToothIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>
);

const EyeIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
    </svg>
);

const DocumentMagnifyingGlassIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m5.231 13.481L16.5 19.5m-1.699-1.699a7.5 7.5 0 111.699-1.699z" />
    </svg>
);

const CertificateIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
    </svg>
);

const CalculatorIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
    </svg>
);

const ClipboardDocumentCheckIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.25-4.875c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0117.25 18.75h-8.5A2.25 2.25 0 016.5 16.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.747-.057 1.124-.08M15 12.75a3 3 0 11-6 0 3 3 0 016 0zm-3-2.25a.75.75 0 00-.75.75v.75h-.75a.75.75 0 000 1.5h.75v.75a.75.75 0 001.5 0v-.75h.75a.75.75 0 000-1.5H12v-.75a.75.75 0 00-.75-.75z" />
    </svg>
);

const CheckIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
    </svg>
);

const ArrowDownTrayIcon = ({ className }) => (
    <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
    </svg>
);

// Utility function for class names
const clsx = (...classes) => classes.filter(Boolean).join(' ');

const Menu = ({ children }) => {
    const [isOpen, setIsOpen] = useState(false);
    const [dropdownPosition, setDropdownPosition] = useState("bottom");
    const menuRef = useRef(null);

    const toggleMenu = () => {
        if (!isOpen && menuRef.current) {
            const rect = menuRef.current.getBoundingClientRect();
            const viewportHeight = window.innerHeight;
            const dropdownHeight = 200; // Dropdown ke liye fixed height

            const spaceBelow = viewportHeight - rect.bottom;
            const spaceAbove = rect.top;

            if (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) {
                setDropdownPosition("top");
            } else {
                setDropdownPosition("bottom");
            }
        }
        setIsOpen(!isOpen);
    };

    useEffect(() => {
        const handleClickOutside = (event) => {
            if (menuRef.current && !menuRef.current.contains(event.target)) {
                setIsOpen(false);
            }
        };
        if (isOpen) {
            document.addEventListener("mousedown", handleClickOutside);
        }
        return () => {
            document.removeEventListener("mousedown", handleClickOutside);
        };
    }, [isOpen]);

    return (
        <div className="relative inline-block text-left" ref={menuRef}>
            {React.Children.map(children, (child) => {
                if (child.type === MenuButton) {
                    return React.cloneElement(child, { onClick: toggleMenu });
                }
                if (child.type === MenuItems) {
                    return isOpen
                        ? React.cloneElement(child, {
                            onClose: () => setIsOpen(false),
                            position: dropdownPosition,
                        })
                        : null;
                }
                return child;
            })}
        </div>
    );
};

const MenuButton = ({ children, onClick }) => {
    return (
        <button
            onClick={onClick}
            className="inline-flex justify-center items-center w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors"
        >
            {children}
        </button>
    );
};

const MenuItems = ({ children, onClose, position = "bottom" }) => {
    const positionClasses =
        position === "top"
            ? "bottom-full mb-2"
            : "top-full mt-2 -translate-y-16"; 

    return (
        <>
            <div className="fixed inset-0 z-40" onClick={onClose} />
            <div
                className={`absolute right-0 z-50 ${positionClasses} w-64 origin-top-right
                divide-y divide-gray-100 dark:divide-gray-600 rounded-md
                bg-white dark:bg-gray-800 shadow-xl
                ring-1 ring-black ring-opacity-5
                border border-gray-200 dark:border-gray-600`}
                style={{ maxHeight: "160px", overflowY: "auto" }} 
            >
                <div className="py-1">{children}</div>
            </div>
        </>
    );
};



const MenuItem = ({ children }) => {
    const [active, setActive] = useState(false);

    return (
        <div
            onMouseEnter={() => setActive(true)}
            onMouseLeave={() => setActive(false)}
        >
            {children({ active })}
        </div>
    );
};

export function PerformActions({ item, onAction }) {
    // Theme state for light/dark mode
    const [theme, setTheme] = useState('light');

    // Theme detection
    useEffect(() => {
        // Check if window is defined before accessing it
        if (typeof window !== 'undefined') {
            const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
            setTheme(prefersDark ? 'dark' : 'light');

            const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
            const handleChange = (e) => setTheme(e.matches ? 'dark' : 'light');
            mediaQuery.addEventListener("change", handleChange);

            return () => mediaQuery.removeEventListener("change", handleChange);
        }
    }, []);

    const permissions = typeof window !== 'undefined' ? localStorage.getItem('userPermissions')?.split(',').map(Number) || [] : [];

    // In PerformActions.jsx, update the performActions array:

    const performActions = [
        // STEP 1: Before allotment - ONLY show upload document
        ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length === 0
            ? [
                {
                    label: 'Upload Document',
                    action: 'uploadDocument',
                    icon: DocumentArrowUpIcon,
                    color: 'text-blue-600',
                    hoverColor: 'hover:bg-blue-50 hover:text-blue-700',
                },
            ]
            : []),

        // Show view documents if uploaded but not allotted
        ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length > 0
            ? [
                {
                    label: 'View Documents',
                    action: 'viewDocuments',
                    icon: DocumentTextIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
            ]
            : []),

        // STEP 2: After allotment - Show Add CRF, Clone Item, Request Cancel LRN, Request Revision
        ...(item.allotedto && item.status === -1
            ? [
                {
                    label: 'Upload Document',
                    action: 'uploadDocument',
                    icon: DocumentArrowUpIcon,
                    color: 'text-blue-600',
                    hoverColor: 'hover:bg-blue-50 hover:text-blue-700',
                },
                {
                    label: 'Add Crf',
                    permission: 113,
                    action: 'addCrf',
                    icon: PlusIcon,
                    color: 'text-green-600',
                    hoverColor: 'hover:bg-green-50 hover:text-green-700',
                },
                {
                    label: 'Clone Item',
                    permission: 113,
                    action: 'cloneItem',
                    icon: DocumentDuplicateIcon,
                    color: 'text-purple-600',
                    hoverColor: 'hover:bg-purple-50 hover:text-purple-700',
                },
            ]
            : []),

        // STEP 3: Status 0 or 11 - Edit and Calibrate Step 1
        ...(item.allotedto && (item.status === 0 || item.status === 11)
            ? [
                {
                    label: 'Edit Instrument Detail',
                    permission: 114,
                    action: 'editInstrumentDetail',
                    icon: PencilIcon,
                    color: 'text-indigo-600',
                    hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
                },
                {
                    label: 'Calibrate Step 1',
                    permission: 103,
                    action: 'calibrateStep1',
                    icon: WrenchScrewdriverIcon,
                    color: 'text-teal-600',
                    hoverColor: 'hover:bg-teal-50 hover:text-teal-700',
                },
            ]
            : []),

        // STEP 4: Status 1 - Calibrate Step 2
        ...(item.allotedto && item.status === 1
            ? [
                {
                    label: 'Back To Step 1',
                    permission: 103,
                    action: 'backToStep1',
                    icon: ArrowLeftIcon,
                    color: 'text-gray-600',
                    hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
                },
                {
                    label: 'Edit Instrument Detail',
                    permission: 114,
                    action: 'editInstrumentDetail',
                    icon: PencilIcon,
                    color: 'text-indigo-600',
                    hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
                },
                {
                    label: 'Calibrate Step 2',
                    permission: 103,
                    action: 'calibrateStep2',
                    icon: WrenchScrewdriverIcon,
                    color: 'text-teal-700',
                    hoverColor: 'hover:bg-teal-50 hover:text-teal-800',
                },
            ]
            : []),

        // STEP 5: Status 2 - Change Master, Edit Calib Point
        ...(item.allotedto && item.status === 2
            ? [
                {
                    label: 'Edit Instrument Detail',
                    permission: 114,
                    action: 'editInstrumentDetail',
                    icon: PencilIcon,
                    color: 'text-indigo-600',
                    hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
                },
                {
                    label: 'Back To Step 1',
                    permission: 103,
                    action: 'backToStep1',
                    icon: ArrowLeftIcon,
                    color: 'text-gray-600',
                    hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
                },
                {
                    label: 'Change Master',
                    permission: 103,
                    action: 'changeMaster',
                    icon: Cog6ToothIcon,
                    color: 'text-pink-600',
                    hoverColor: 'hover:bg-pink-50 hover:text-pink-700',
                },
                {
                    label: 'Edit Calib Point',
                    permission: 114,
                    action: 'editCalibPoint',
                    icon: PencilIcon,
                    color: 'text-violet-600',
                    hoverColor: 'hover:bg-violet-50 hover:text-violet-700',
                },
            ]
            : []),

        // STEP 6: Status 3 - View Rawdata, Calculate Uncertainty, View Certificate, Approve
        ...(item.allotedto && item.status === 3
            ? [
                {
                    label: 'Edit Calib Point',
                    permission: 114,
                    action: 'editCalibPoint',
                    icon: PencilIcon,
                    color: 'text-violet-600',
                    hoverColor: 'hover:bg-violet-50 hover:text-violet-700',
                },
                {
                    label: 'Back To Step 1',
                    permission: 103,
                    action: 'backToStep1',
                    icon: ArrowLeftIcon,
                    color: 'text-gray-600',
                    hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
                },
                {
                    label: 'Edit Instrument Detail',
                    permission: 114,
                    action: 'editInstrumentDetail',
                    icon: PencilIcon,
                    color: 'text-indigo-600',
                    hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
                },
                {
                    label: 'View Rawdata',
                    permission: [104, 105],
                    action: 'viewRawdata',
                    icon: EyeIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                {
                    label: "Calculate Uncertainty",
                    permission: [104, 105],
                    action: "calculateUncertainty",
                    icon: CalculatorIcon,
                    color: "text-green-700",
                    hoverColor: "hover:bg-green-50 hover:text-green-800"
                },
                {
                    label: 'View Certificate',
                    permission: [104, 105, 278],
                    action: 'viewCertificate',
                    icon: CertificateIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                ...(item.accreditation === 'Nabl'
                    ? [
                        {
                            label: 'View CMC Calculation',
                            action: 'viewCMCCalculation',
                            icon: CalculatorIcon,
                            color: 'text-cyan-600',
                            hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                        },
                    ]
                    : []),
                {
                    label: 'Approve',
                    permission: [105],
                    action: 'approve',
                    icon: CheckIcon,
                    color: 'text-green-700',
                    hoverColor: 'hover:bg-green-50 hover:text-green-800',
                },
            ]
            : []),

        // STEP 7: Status 5 - Approved (Final state)
        ...(item.allotedto && item.status === 5
            ? [
                {
                    label: 'View Rawdata',
                    action: 'viewRawdata',
                    icon: EyeIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                {
                    label: 'Regenerate Cache Copy',
                    permission: [105, 482],
                    action: 'regenerateCache',
                    icon: ArrowDownTrayIcon,
                    color: 'text-orange-600',
                    hoverColor: 'hover:bg-orange-50 hover:text-orange-700',
                },
                {
                    label: 'View Certificate',
                    permission: [104, 105, 482],
                    action: item.fileWithFullPath ? 'viewApprovedCertificate' : 'viewCertificate',
                    icon: CertificateIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                {
                    label: 'View Certificate with l/h',
                    permission: [104, 105, 482],
                    action: 'viewCertificateWithLH',
                    icon: CertificateIcon,
                    color: 'text-cyan-800',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-900',
                },
            ]
            : []),

        // View Traceability - Available for status 3, 4, 5
        ...(item.allotedto && item.status >= 3 && item.status <= 5
            ? [
                {
                    label: 'View Tracebility',
                    action: 'viewTraceability',
                    icon: DocumentMagnifyingGlassIcon,
                    color: 'text-cyan-700',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-800',
                },
            ]
            : []),

        // CMC Calculation for approved NABL items
        ...(item.allotedto && item.status === 5 && item.accreditation === 'Nabl'
            ? [
                {
                    label: 'View CMC Calculation',
                    action: 'viewCMCCalculation',
                    icon: CalculatorIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
            ]
            : []),

        // Cancel CRF - Available for status 0, 1, 2 (only after allotment)
        ...(item.allotedto && item.status >= 0 && item.status <= 2
            ? [
                {
                    label: 'Cancel Crf',
                    action: 'cancelCrf',
                    icon: XMarkIcon,
                    color: 'text-red-600',
                    hoverColor: 'hover:bg-red-50 hover:text-red-700',
                },
            ]
            : []),

        // Request Cancel LRN - Available for all statuses after allotment (until status 3)
        ...(item.allotedto && item.status >= -1 && item.status <= 3
            ? [
                {
                    label: 'Request Cancel LRN',
                    permission: 103,
                    action: 'requestCancelLRN',
                    icon: ExclamationTriangleIcon,
                    color: 'text-red-700',
                    hoverColor: 'hover:bg-red-50 hover:text-red-800',
                },
            ]
            : []),

        // Revision workflows
        ...(item.allotedto && item.status === 81
            ? [
                {
                    label: 'Edit Details for revision',
                    permission: 105,
                    action: 'editDetailsForRevision',
                    icon: PencilIcon,
                    color: 'text-yellow-600',
                    hoverColor: 'hover:bg-yellow-50 hover:text-yellow-700',
                },
            ]
            : []),

        ...(item.allotedto && item.status === 82
            ? [
                {
                    label: 'View Rawdata',
                    action: 'viewRawdata',
                    icon: EyeIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                {
                    label: 'View Certificate',
                    permission: [104, 105],
                    action: 'viewCertificate',
                    icon: CertificateIcon,
                    color: 'text-cyan-600',
                    hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                },
                ...(item.accreditation === 'Nabl'
                    ? [
                        {
                            label: 'View CMC Calculation',
                            permission: [104, 105],
                            action: 'viewCMCCalculation',
                            icon: CalculatorIcon,
                            color: 'text-cyan-600',
                            hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
                        },
                    ]
                    : []),
                {
                    label: 'Review',
                    permission: [227, 115],
                    action: 'review',
                    icon: ClipboardDocumentCheckIcon,
                    color: 'text-blue-700',
                    hoverColor: 'hover:bg-blue-50 hover:text-blue-800',
                },
            ]
            : []),

        // Request Revision - Available for all states after allotment
        ...(item.allotedto
            ? [
                {
                    label: 'Request Revision',
                    action: 'requestRevision',
                    icon: ArrowPathIcon,
                    color: 'text-orange-600',
                    hoverColor: 'hover:bg-orange-50 hover:text-orange-700',
                },
            ]
            : []),
    ];

    const filteredActions = performActions.filter(
        (action) => !action.permission || (Array.isArray(action.permission) ? action.permission.some((p) => permissions.includes(p)) : permissions.includes(action.permission))
    );

    const handleActionClick = (action) => {
        //console.log('PerformActions: Triggering action:', action);
        onAction(action, item);
    };

    return (
        <div className={`flex justify-center ${theme === 'dark' ? 'dark' : ''}`}>
            <Menu>
                <MenuButton>
                    <EllipsisHorizontalIcon className="w-4 h-4 text-gray-600 dark:text-gray-300" />
                </MenuButton>

                <MenuItems>
                    {filteredActions.map((action, index) => {
                        const IconComponent = action.icon;
                        return (
                            <MenuItem key={`${action.action}-${index}`}>
                                {({ active }) => (
                                    <button
                                        onClick={() => handleActionClick(action.action)}
                                        className={clsx(
                                            "group flex w-full items-center px-4 py-2 text-sm font-medium transition-colors duration-150",
                                            active
                                                ? action.hoverColor
                                                : action.color,
                                            "hover:bg-opacity-10"
                                        )}
                                    >
                                        <IconComponent className="mr-3 h-4 w-4 flex-shrink-0" />
                                        <span className="truncate">{action.label}</span>
                                    </button>
                                )}
                            </MenuItem>
                        );
                    })}
                </MenuItems>
            </Menu>
        </div>
    );
}

PerformActions.propTypes = {
    item: PropTypes.object.isRequired,
    onAction: PropTypes.func.isRequired,
};


















// --------------ye mera sahi code hai action button bhar h or color m h  -----------------








// import  { useState, useEffect} from 'react';
// import PropTypes from 'prop-types';
// import { Button } from 'components/ui';



// // Simple icons as SVG components if heroicons not available
// // const EllipsisHorizontalIcon = ({ className }) => (
// //     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
// //         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
// //     </svg>
// // );

// const DocumentArrowUpIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
//     </svg>
// );

// const DocumentTextIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
//     </svg>
// );

// const PlusIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
//     </svg>
// );

// const DocumentDuplicateIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
//     </svg>
// );

// const PencilIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
//     </svg>
// );

// const XMarkIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
//     </svg>
// );

// const ExclamationTriangleIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.764 0L3.034 16.5c-.77.833.192 2.5 1.732 2.5z" />
//     </svg>
// );

// const ArrowPathIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m-4.991 0v4.994" />
//     </svg>
// );

// const WrenchScrewdriverIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z" />
//     </svg>
// );

// const ArrowLeftIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
//     </svg>
// );

// const Cog6ToothIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
//     </svg>
// );

// const EyeIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
//     </svg>
// );

// const DocumentMagnifyingGlassIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m5.231 13.481L16.5 19.5m-1.699-1.699a7.5 7.5 0 111.699-1.699z" />
//     </svg>
// );

// const CertificateIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
//     </svg>
// );

// const CalculatorIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
//     </svg>
// );

// const ClipboardDocumentCheckIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.25-4.875c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0117.25 18.75h-8.5A2.25 2.25 0 016.5 16.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.747-.057 1.124-.08M15 12.75a3 3 0 11-6 0 3 3 0 016 0zm-3-2.25a.75.75 0 00-.75.75v.75h-.75a.75.75 0 000 1.5h.75v.75a.75.75 0 001.5 0v-.75h.75a.75.75 0 000-1.5H12v-.75a.75.75 0 00-.75-.75z" />
//     </svg>
// );

// const CheckIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
//     </svg>
// );

// const ArrowDownTrayIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
//     </svg>
// );

// // Utility function for class names
// const clsx = (...classes) => {
//     return classes.filter(Boolean).join(' ');
// };

// export function PerformActions({ item, onAction }) {
//     // Theme state for light/dark mode
//     const [theme, setTheme] = useState('light');

//     // Theme detection
//     useEffect(() => {
//         const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
//         setTheme(prefersDark ? 'dark' : 'light');

//         const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
//         const handleChange = (e) => setTheme(e.matches ? 'dark' : 'light');
//         mediaQuery.addEventListener("change", handleChange);

//         return () => mediaQuery.removeEventListener("change", handleChange);
//     }, []);

//     const permissions = typeof window !== 'undefined' ? localStorage.getItem('userPermissions')?.split(',').map(Number) || [] : [];
//     // Define all perform actions with icons and colors
    
//     // const performActions = [
//     //     // STEP 1: Before allotment - ONLY show upload document
//     //     ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length === 0
//     //         ? [
//     //             {
//     //                 label: 'Upload Document',
//     //                 action: 'uploadDocument',
//     //                 icon: DocumentArrowUpIcon,
//     //                 color: 'text-blue-600',
//     //                 hoverColor: 'hover:bg-blue-50 hover:text-blue-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // Show view documents if uploaded but not allotted
//     //     ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length > 0
//     //         ? [
//     //             {
//     //                 label: 'View Documents',
//     //                 action: 'viewDocuments',
//     //                 icon: DocumentTextIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 2: After allotment - Show Add CRF, Clone Item, Request Cancel LRN, Request Revision
//     //     ...(item.allotedto && item.status === -1
//     //         ? [
//     //             {
//     //                 label: 'Upload Document',
//     //                 action: 'uploadDocument',
//     //                 icon: DocumentArrowUpIcon,
//     //                 color: 'text-blue-600',
//     //                 hoverColor: 'hover:bg-blue-50 hover:text-blue-700',
//     //             },
//     //             {
//     //                 label: 'Add Crf',
//     //                 permission: 113,
//     //                 action: 'addCrf',
//     //                 icon: PlusIcon,
//     //                 color: 'text-green-600',
//     //                 hoverColor: 'hover:bg-green-50 hover:text-green-700',
//     //             },
//     //             {
//     //                 label: 'Clone Item',
//     //                 permission: 113,
//     //                 action: 'cloneItem',
//     //                 icon: DocumentDuplicateIcon,
//     //                 color: 'text-purple-600',
//     //                 hoverColor: 'hover:bg-purple-50 hover:text-purple-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 3: Status 0 or 11 - Edit and Calibrate Step 1
//     //     ...(item.allotedto && (item.status === 0 || item.status === 11)
//     //         ? [
//     //             {
//     //                 label: 'Edit Instrument Detail',
//     //                 permission: 114,
//     //                 action: 'editInstrumentDetail',
//     //                 icon: PencilIcon,
//     //                 color: 'text-indigo-600',
//     //                 hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
//     //             },
//     //             {
//     //                 label: 'Calibrate Step 1',
//     //                 permission: 103,
//     //                 action: 'calibrateStep1',
//     //                 icon: WrenchScrewdriverIcon,
//     //                 color: 'text-teal-600',
//     //                 hoverColor: 'hover:bg-teal-50 hover:text-teal-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 4: Status 1 - Calibrate Step 2
//     //     ...(item.allotedto && item.status === 1
//     //         ? [
//     //             {
//     //                 label: 'Back To Step 1',
//     //                 permission: 103,
//     //                 action: 'backToStep1',
//     //                 icon: ArrowLeftIcon,
//     //                 color: 'text-gray-600',
//     //                 hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
//     //             },
//     //             {
//     //                 label: 'Edit Instrument Detail',
//     //                 permission: 114,
//     //                 action: 'editInstrumentDetail',
//     //                 icon: PencilIcon,
//     //                 color: 'text-indigo-600',
//     //                 hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
//     //             },
//     //             {
//     //                 label: 'Calibrate Step 2',
//     //                 permission: 103,
//     //                 action: 'calibrateStep2',
//     //                 icon: WrenchScrewdriverIcon,
//     //                 color: 'text-teal-700',
//     //                 hoverColor: 'hover:bg-teal-50 hover:text-teal-800',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 5: Status 2 - Change Master, Edit Calib Point
//     //     ...(item.allotedto && item.status === 2
//     //         ? [
//     //             {
//     //                 label: 'Edit Instrument Detail',
//     //                 permission: 114,
//     //                 action: 'editInstrumentDetail',
//     //                 icon: PencilIcon,
//     //                 color: 'text-indigo-600',
//     //                 hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
//     //             },
//     //             {
//     //                 label: 'Back To Step 1',
//     //                 permission: 103,
//     //                 action: 'backToStep1',
//     //                 icon: ArrowLeftIcon,
//     //                 color: 'text-gray-600',
//     //                 hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
//     //             },
//     //             {
//     //                 label: 'Change Master',
//     //                 permission: 103,
//     //                 action: 'changeMaster',
//     //                 icon: Cog6ToothIcon,
//     //                 color: 'text-pink-600',
//     //                 hoverColor: 'hover:bg-pink-50 hover:text-pink-700',
//     //             },
//     //             {
//     //                 label: 'Edit Calib Point',
//     //                 permission: 114,
//     //                 action: 'editCalibPoint',
//     //                 icon: PencilIcon,
//     //                 color: 'text-violet-600',
//     //                 hoverColor: 'hover:bg-violet-50 hover:text-violet-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 6: Status 3 - View Rawdata, Calculate Uncertainty, View Certificate, Approve
//     //     ...(item.allotedto && item.status === 3
//     //         ? [
//     //             {
//     //                 label: 'Edit Calib Point',
//     //                 permission: 114,
//     //                 action: 'editCalibPoint',
//     //                 icon: PencilIcon,
//     //                 color: 'text-violet-600',
//     //                 hoverColor: 'hover:bg-violet-50 hover:text-violet-700',
//     //             },
//     //             {
//     //                 label: 'Back To Step 1',
//     //                 permission: 103,
//     //                 action: 'backToStep1',
//     //                 icon: ArrowLeftIcon,
//     //                 color: 'text-gray-600',
//     //                 hoverColor: 'hover:bg-gray-50 hover:text-gray-700',
//     //             },
//     //             {
//     //                 label: 'Edit Instrument Detail',
//     //                 permission: 114,
//     //                 action: 'editInstrumentDetail',
//     //                 icon: PencilIcon,
//     //                 color: 'text-indigo-600',
//     //                 hoverColor: 'hover:bg-indigo-50 hover:text-indigo-700',
//     //             },
//     //             {
//     //                 label: 'View Rawdata',
//     //                 permission: [104, 105],
//     //                 action: 'viewRawdata',
//     //                 icon: EyeIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             {
//     //                 label: "Calculate Uncertainty",
//     //                 permission: [104, 105],
//     //                 action: "calculateUncertainty",
//     //                 icon: CalculatorIcon,
//     //                 color: "text-green-700",
//     //                 hoverColor: "hover:bg-green-50 hover:text-green-800"
//     //             },
//     //             {
//     //                 label: 'View Certificate',
//     //                 permission: [104, 105, 278],
//     //                 action: 'viewCertificate',
//     //                 icon: CertificateIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             ...(item.accreditation === 'Nabl'
//     //                 ? [
//     //                     {
//     //                         label: 'View CMC Calculation',
//     //                         action: 'viewCMCCalculation',
//     //                         icon: CalculatorIcon,
//     //                         color: 'text-cyan-600',
//     //                         hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //                     },
//     //                 ]
//     //                 : []),
//     //             {
//     //                 label: 'Approve',
//     //                 permission: [105],
//     //                 action: 'approve',
//     //                 icon: CheckIcon,
//     //                 color: 'text-green-700',
//     //                 hoverColor: 'hover:bg-green-50 hover:text-green-800',
//     //             },
//     //         ]
//     //         : []),

//     //     // STEP 7: Status 5 - Approved (Final state)
//     //     ...(item.allotedto && item.status === 5
//     //         ? [
//     //             {
//     //                 label: 'View Rawdata',
//     //                 action: 'viewRawdata',
//     //                 icon: EyeIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             {
//     //                 label: 'Regenerate Cache Copy',
//     //                 permission: [105, 482],
//     //                 action: 'regenerateCache',
//     //                 icon: ArrowDownTrayIcon,
//     //                 color: 'text-orange-600',
//     //                 hoverColor: 'hover:bg-orange-50 hover:text-orange-700',
//     //             },
//     //             {
//     //                 label: 'View Certificate',
//     //                 permission: [104, 105, 482],
//     //                 action: item.fileWithFullPath ? 'viewApprovedCertificate' : 'viewCertificate',
//     //                 icon: CertificateIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             {
//     //                 label: 'View Certificate with l/h',
//     //                 permission: [104, 105, 482],
//     //                 action: 'viewCertificateWithLH',
//     //                 icon: CertificateIcon,
//     //                 color: 'text-cyan-800',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-900',
//     //             },
//     //         ]
//     //         : []),

//     //     // View Traceability - Available for status 3, 4, 5
//     //     ...(item.allotedto && item.status >= 3 && item.status <= 5
//     //         ? [
//     //             {
//     //                 label: 'View Tracebility',
//     //                 action: 'viewTraceability',
//     //                 icon: DocumentMagnifyingGlassIcon,
//     //                 color: 'text-cyan-700',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-800',
//     //             },
//     //         ]
//     //         : []),

//     //     // CMC Calculation for approved NABL items
//     //     ...(item.allotedto && item.status === 5 && item.accreditation === 'NABL'
//     //         ? [
//     //             {
//     //                 label: 'View CMC Calculation',
//     //                 action: 'viewCMCCalculation',
//     //                 icon: CalculatorIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // Cancel CRF - Available for status 0, 1, 2 (only after allotment)
//     //     ...(item.allotedto && item.status >= 0 && item.status <= 2
//     //         ? [
//     //             {
//     //                 label: 'Cancel Crf',
//     //                 action: 'cancelCrf',
//     //                 icon: XMarkIcon,
//     //                 color: 'text-red-600',
//     //                 hoverColor: 'hover:bg-red-50 hover:text-red-700',
//     //             },
//     //         ]
//     //         : []),

//     //     // Request Cancel LRN - Available for all statuses after allotment (until status 3)
//     //     ...(item.allotedto && item.status >= -1 && item.status <= 3
//     //         ? [
//     //             {
//     //                 label: 'Request Cancel LRN',
//     //                 permission: 103,
//     //                 action: 'requestCancelLRN',
//     //                 icon: ExclamationTriangleIcon,
//     //                 color: 'text-red-700',
//     //                 hoverColor: 'hover:bg-red-50 hover:text-red-800',
//     //             },
//     //         ]
//     //         : []),

//     //     // Revision workflows
//     //     ...(item.allotedto && item.status === 81
//     //         ? [
//     //             {
//     //                 label: 'Edit Details for revision',
//     //                 permission: 105,
//     //                 action: 'editDetailsForRevision',
//     //                 icon: PencilIcon,
//     //                 color: 'text-yellow-600',
//     //                 hoverColor: 'hover:bg-yellow-50 hover:text-yellow-700',
//     //             },
//     //         ]
//     //         : []),

//     //     ...(item.allotedto && item.status === 82
//     //         ? [
//     //             {
//     //                 label: 'View Rawdata',
//     //                 action: 'viewRawdata',
//     //                 icon: EyeIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             {
//     //                 label: 'View Certificate',
//     //                 permission: [104, 105],
//     //                 action: 'viewCertificate',
//     //                 icon: CertificateIcon,
//     //                 color: 'text-cyan-600',
//     //                 hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //             },
//     //             ...(item.accreditation === 'NABL'
//     //                 ? [
//     //                     {
//     //                         label: 'View CMC Calculation',
//     //                         permission: [104, 105],
//     //                         action: 'viewCMCCalculation',
//     //                         icon: CalculatorIcon,
//     //                         color: 'text-cyan-600',
//     //                         hoverColor: 'hover:bg-cyan-50 hover:text-cyan-700',
//     //                     },
//     //                 ]
//     //                 : []),
//     //             {
//     //                 label: 'Review',
//     //                 permission: [227, 115],
//     //                 action: 'review',
//     //                 icon: ClipboardDocumentCheckIcon,
//     //                 color: 'text-blue-700',
//     //                 hoverColor: 'hover:bg-blue-50 hover:text-blue-800',
//     //             },
//     //         ]
//     //         : []),

//     //     // Request Revision - Available for all states after allotment
//     //     ...(item.allotedto
//     //         ? [
//     //             {
//     //                 label: 'Request Revision',
//     //                 action: 'requestRevision',
//     //                 icon: ArrowPathIcon,
//     //                 color: 'text-orange-600',
//     //                 hoverColor: 'hover:bg-orange-50 hover:text-orange-700',
//     //             },
//     //         ]
//     //         : []),
//     // ];
//     const performActions = [
//   // STEP 1: Before allotment - ONLY show upload document
//   ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length === 0
//     ? [
//         {
//           label: 'Upload Document',
//           action: 'uploadDocument',
//           icon: DocumentArrowUpIcon,
//           color: 'bg-gradient-to-r from-sky-400 to-blue-500 hover:from-sky-500 hover:to-blue-600 text-white',
//         },
      
//       ]
//     : []),

//   // Show view documents if uploaded but not allotted
//   ...((!item.allotedto || item.allotedto === '' || item.allotedto === null) && item.status < 1 && item.itemdocument.length > 0
//     ? [
//         {
//           label: 'View Documents',
//           action: 'viewDocuments',
//           icon: DocumentTextIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//       ]
//     : []),

//   // STEP 2: After allotment - Show Add CRF, Clone Item, Request Cancel LRN, Request Revision
//   ...(item.allotedto && item.status === -1
//     ? [
//         {
//           label: 'Upload Document',
//           action: 'uploadDocument',
//           icon: DocumentArrowUpIcon,
//           color: 'bg-gradient-to-r from-sky-400 to-blue-500 hover:from-sky-500 hover:to-blue-600 text-white',
//         },
//         {
//           label: 'View Documents',
//           action: 'viewDocuments',
//           icon: DocumentTextIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         {
//           label: 'Add Crf',
//           permission: 113,
//           action: 'addCrf',
//           icon: PlusIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//         {
//           label: 'Clone Item',
//           permission: 113,
//           action: 'cloneItem',
//           icon: DocumentDuplicateIcon,
//           color: 'bg-gradient-to-r from-fuchsia-400 to-purple-600 hover:from-fuchsia-500 hover:to-purple-700 text-white',
//         },
//       ]
//     : []),

//   // STEP 3: Status 0 or 11 - Edit and Calibrate Step 1
//   ...(item.allotedto && (item.status === 0 || item.status === 11)
//     ? [
//         {
//           label: 'Edit Instrument Detail',
//           permission: 114,
//           action: 'editInstrumentDetail',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//         {
//           label: 'Calibrate Step 1',
//           permission: 103,
//           action: 'calibrateStep1',
//           icon: WrenchScrewdriverIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//       ]
//     : []),

//   // STEP 4: Status 1 - Calibrate Step 2
//   ...(item.allotedto && item.status === 1
//     ? [
//         {
//           label: 'Back To Step 1',
//           permission: 103,
//           action: 'backToStep1',
//           icon: ArrowLeftIcon,
//           color: 'bg-gradient-to-r from-gray-400 to-slate-500 hover:from-gray-500 hover:to-slate-600 text-white',
//         },
//         {
//           label: 'Edit Instrument Detail',
//           permission: 114,
//           action: 'editInstrumentDetail',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//         {
//           label: 'Calibrate Step 2',
//           permission: 103,
//           action: 'calibrateStep2',
//           icon: WrenchScrewdriverIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//       ]
//     : []),

//   // STEP 5: Status 2 - Change Master, Edit Calib Point
//   ...(item.allotedto && item.status === 2
//     ? [
//         {
//           label: 'Edit Instrument Detail',
//           permission: 114,
//           action: 'editInstrumentDetail',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//         {
//           label: 'Back To Step 1',
//           permission: 103,
//           action: 'backToStep1',
//           icon: ArrowLeftIcon,
//           color: 'bg-gradient-to-r from-gray-400 to-slate-500 hover:from-gray-500 hover:to-slate-600 text-white',
//         },
//         {
//           label: 'Change Master',
//           permission: 103,
//           action: 'changeMaster',
//           icon: Cog6ToothIcon,
//           color: 'bg-gradient-to-r from-fuchsia-400 to-purple-600 hover:from-fuchsia-500 hover:to-purple-700 text-white',
//         },
//         {
//           label: 'Edit Calib Point',
//           permission: 114,
//           action: 'editCalibPoint',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//       ]
//     : []),

//   // STEP 6: Status 3 - View Rawdata, Calculate Uncertainty, View Certificate, Approve
//   ...(item.allotedto && item.status === 3
//     ? [
//         {
//           label: 'Edit Calib Point',
//           permission: 114,
//           action: 'editCalibPoint',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//         {
//           label: 'Back To Step 1',
//           permission: 103,
//           action: 'backToStep1',
//           icon: ArrowLeftIcon,
//           color: 'bg-gradient-to-r from-gray-400 to-slate-500 hover:from-gray-500 hover:to-slate-600 text-white',
//         },
//         {
//           label: 'Edit Instrument Detail',
//           permission: 114,
//           action: 'editInstrumentDetail',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-indigo-400 to-indigo-600 hover:from-indigo-500 hover:to-indigo-700 text-white',
//         },
//         {
//           label: 'View Rawdata',
//           permission: [104, 105],
//           action: 'viewRawdata',
//           icon: EyeIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         {
//           label: 'Calculate Uncertainty',
//           permission: [104, 105],
//           action: 'calculateUncertainty',
//           icon: CalculatorIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//         {
//           label: 'View Certificate',
//           permission: [104, 105, 278],
//           action: 'viewCertificate',
//           icon: CertificateIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         ...(item.accreditation === 'NABL'
//           ? [
//               {
//                 label: 'View CMC Calculation',
//                 action: 'viewCMCCalculation',
//                 icon: CalculatorIcon,
//                 color: 'bg-gradient-to-r from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white',
//               },
//             ]
//           : []),
//         {
//           label: 'Approve',
//           permission: [105],
//           action: 'approve',
//           icon: CheckIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//       ]
//     : []),

//   // STEP 7: Status 5 - Approved (Final state)
//   ...(item.allotedto && item.status === 5
//     ? [
//         {
//           label: 'View Rawdata',
//           action: 'viewRawdata',
//           icon: EyeIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         {
//           label: 'Regenerate Cache Copy',
//           permission: [105, 482],
//           action: 'regenerateCache',
//           icon: ArrowDownTrayIcon,
//           color: 'bg-gradient-to-r from-fuchsia-400 to-purple-600 hover:from-fuchsia-500 hover:to-purple-700 text-white',
//         },
//         {
//           label: 'View Certificate',
//           permission: [104, 105, 482],
//           action: item.fileWithFullPath ? 'viewApprovedCertificate' : 'viewCertificate',
//           icon: CertificateIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         {
//           label: 'View Certificate with l/h',
//           permission: [104, 105, 482],
//           action: 'viewCertificateWithLH',
//           icon: CertificateIcon,
//           color: 'bg-gradient-to-r from-cyan-500 to-teal-600 hover:from-cyan-600 hover:to-teal-700 text-white',
//         },
//       ]
//     : []),

//   // View Traceability
//   ...(item.allotedto && item.status >= 3 && item.status <= 5
//     ? [
//         {
//           label: 'View Tracebility',
//           action: 'viewTraceability',
//           icon: DocumentMagnifyingGlassIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//       ]
//     : []),

//   // CMC Calculation for approved NABL items
//   ...(item.allotedto && item.status === 5 && item.accreditation === 'NABL'
//     ? [
//         {
//           label: 'View CMC Calculation',
//           action: 'viewCMCCalculation',
//           icon: CalculatorIcon,
//           color: 'bg-gradient-to-r from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white',
//         },
//       ]
//     : []),

//   // Cancel CRF
//   ...(item.allotedto && item.status >= 0 && item.status <= 2
//     ? [
//         {
//           label: 'Cancel Crf',
//           action: 'cancelCrf',
//           icon: XMarkIcon,
//           color: 'bg-gradient-to-r from-rose-400 to-red-600 hover:from-rose-500 hover:to-red-700 text-white',
//         },
//       ]
//     : []),

//   // Request Cancel LRN
//   ...(item.allotedto && item.status >= -1 && item.status <= 3
//     ? [
//         {
//           label: 'Request Cancel LRN',
//           permission: 103,
//           action: 'requestCancelLRN',
//           icon: ExclamationTriangleIcon,
//           color: 'bg-gradient-to-r from-rose-400 to-red-600 hover:from-rose-500 hover:to-red-700 text-white',
//         },
//       ]
//     : []),

//   // Revision workflows
//   ...(item.allotedto && item.status === 81
//     ? [
//         {
//           label: 'Edit Details for revision',
//           permission: 105,
//           action: 'editDetailsForRevision',
//           icon: PencilIcon,
//           color: 'bg-gradient-to-r from-amber-400 to-orange-500 hover:from-amber-500 hover:to-orange-600 text-white',
//         },
//       ]
//     : []),

//   ...(item.allotedto && item.status === 82
//     ? [
//         {
//           label: 'View Rawdata',
//           action: 'viewRawdata',
//           icon: EyeIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         {
//           label: 'View Certificate',
//           permission: [104, 105],
//           action: 'viewCertificate',
//           icon: CertificateIcon,
//           color: 'bg-gradient-to-r from-cyan-400 to-teal-500 hover:from-cyan-500 hover:to-teal-600 text-white',
//         },
//         ...(item.accreditation === 'NABL'
//           ? [
//               {
//                 label: 'View CMC Calculation',
//                 permission: [104, 105],
//                 action: 'viewCMCCalculation',
//                 icon: CalculatorIcon,
//                 color: 'bg-gradient-to-r from-teal-400 to-cyan-500 hover:from-teal-500 hover:to-cyan-600 text-white',
//               },
//             ]
//           : []),
//         {
//           label: 'Review',
//           permission: [227, 115],
//           action: 'review',
//           icon: ClipboardDocumentCheckIcon,
//           color: 'bg-gradient-to-r from-emerald-400 to-green-600 hover:from-emerald-500 hover:to-green-700 text-white',
//         },
//       ]
//     : []),

//   // Request Revision
//   ...(item.allotedto
//     ? [
//         {
//           label: 'Request Revision',
//           action: 'requestRevision',
//           icon: ArrowPathIcon,
//           color: 'bg-gradient-to-r from-amber-400 to-orange-500 hover:from-amber-500 hover:to-orange-600 text-white',
//         },
//       ]
//     : []),
// ];


//         const filteredActions = performActions.filter(
//         (action) => !action.permission || (Array.isArray(action.permission) ? action.permission.some((p) => permissions.includes(p)) : permissions.includes(action.permission))
//     );


//     const handleActionClick = (action) => {
//         //console.log('PerformActions: Triggering action:', action);
//         onAction(action, item);
//     };

//     // return (
//     //     <div className={`min-w-[400px] justify-left ${theme === 'dark' ? 'dark' : ''}`}>
//     //         {filteredActions.map((action, index) => {
//     //             const IconComponent = action.icon;
//     //             return (
//     //                 <Button
//     //                     key={`${action.action}-${index}`}
//     //                     onClick={() => handleActionClick(action.action)}
//     //                     className={clsx(
//     //                         "h-6 space-x-2 rounded-md px-1 text-xs font-medium outline-none transition-colors",  
//     //                       action.color,
//     //                         action.hoverColor,
//     //                         "hover:bg-opacity-10"
//     //                     )}
//     //                 >
//     //                     <IconComponent className="mr-2 h-4 w-4 flex-shrink-0" />
//     //                     <span className="truncate">{action.label}</span>
//     //                 </Button>
//     //             );
//     //         })}
//     //     </div>
//     // );
// return (
//   <div
//     className={clsx(
//       "min-w-[400px] flex flex-wrap gap-2 justify-start items-center",
//       theme === "dark" ? "dark" : ""
//     )}
//   >
//     {filteredActions.map((action, index) => {
//       const IconComponent = action.icon;
//       return (
//         <Button
//           key={`${action.action}-${index}`}
//           onClick={() => handleActionClick(action.action)}
//           className={clsx(
//             "h-6 space-x-2 rounded-md px-1 text-xs font-medium outline-none transition-colors",
//             action.color,
//             action.hoverColor,
//             "hover:bg-opacity-10"
//           )}
//         >
//           <IconComponent className="mr-2 h-4 w-4 flex-shrink-0" />
//           <span className="truncate">{action.label}</span>
//         </Button>
//       );
//     })}
//   </div>
// );


// }

// PerformActions.propTypes = {
//     item: PropTypes.object.isRequired,
//     onAction: PropTypes.func.isRequired,
// };














// all button show code -------------------------------------------------------------------------




// import React, { useState, useEffect, useRef } from 'react';
// import PropTypes from 'prop-types';



// // Simple icons as SVG components if heroicons not available
// const EllipsisHorizontalIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
//     </svg>
// );

// const DocumentArrowUpIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
//     </svg>
// );

// const DocumentTextIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
//     </svg>
// );

// const PlusIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
//     </svg>
// );

// const DocumentDuplicateIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
//     </svg>
// );

// const PencilIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
//     </svg>
// );

// const XMarkIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
//     </svg>
// );

// const ExclamationTriangleIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.99-.833-2.764 0L3.034 16.5c-.77.833.192 2.5 1.732 2.5z" />
//     </svg>
// );

// const ArrowPathIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m-4.991 0v4.994" />
//     </svg>
// );

// const WrenchScrewdriverIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z" />
//     </svg>
// );

// const ArrowLeftIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
//     </svg>
// );

// const Cog6ToothIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
//     </svg>
// );

// const EyeIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
//     </svg>
// );

// const DocumentMagnifyingGlassIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m5.231 13.481L16.5 19.5m-1.699-1.699a7.5 7.5 0 111.699-1.699z" />
//     </svg>
// );

// const CertificateIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
//     </svg>
// );

// const CalculatorIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
//     </svg>
// );

// const ClipboardDocumentCheckIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.25-4.875c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0117.25 18.75h-8.5A2.25 2.25 0 016.5 16.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.747-.057 1.124-.08M15 12.75a3 3 0 11-6 0 3 3 0 016 0zm-3-2.25a.75.75 0 00-.75.75v.75h-.75a.75.75 0 000 1.5h.75v.75a.75.75 0 001.5 0v-.75h.75a.75.75 0 000-1.5H12v-.75a.75.75 0 00-.75-.75z" />
//     </svg>
// );

// const CheckIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
//     </svg>
// );

// const ArrowDownTrayIcon = ({ className }) => (
//     <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
//         <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
//     </svg>
// );

// // Simple Menu components using native dropdown
// const Menu = ({ children }) => {
//     const [isOpen, setIsOpen] = useState(false);
//     const [dropdownPosition, setDropdownPosition] = useState('bottom');
//     const menuRef = useRef(null);

//     const toggleMenu = () => {
//         if (!isOpen && menuRef.current) {
//             // Calculate position when opening
//             const rect = menuRef.current.getBoundingClientRect();
//             const viewportHeight = window.innerHeight;
//             const dropdownHeight = 320; // Approximate height of dropdown

//             // Check if there's enough space below
//             const spaceBelow = viewportHeight - rect.bottom;
//             const spaceAbove = rect.top;

//             if (spaceBelow < dropdownHeight && spaceAbove > dropdownHeight) {
//                 setDropdownPosition('top');
//             } else {
//                 setDropdownPosition('bottom');
//             }
//         }
//         setIsOpen(!isOpen);
//     };

//     useEffect(() => {
//         const handleClickOutside = (event) => {
//             if (menuRef.current && !menuRef.current.contains(event.target)) {
//                 setIsOpen(false);
//             }
//         };

//         if (isOpen) {
//             document.addEventListener('mousedown', handleClickOutside);
//         }

//         return () => {
//             document.removeEventListener('mousedown', handleClickOutside);
//         };
//     }, [isOpen]);

//     return (
//         <div className="relative inline-block text-left" ref={menuRef}>
//             {React.Children.map(children, child => {
//                 if (child.type === MenuButton) {
//                     return React.cloneElement(child, { onClick: toggleMenu });
//                 }
//                 if (child.type === MenuItems) {
//                     return isOpen ? React.cloneElement(child, {
//                         onClose: () => setIsOpen(false),
//                         position: dropdownPosition
//                     }) : null;
//                 }
//                 return child;
//             })}
//         </div>
//     );
// };

// const MenuButton = ({ children, onClick }) => {
//     return (
//         <button
//             onClick={onClick}
//             className="inline-flex justify-center items-center w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors"
//         >
//             {children}
//         </button>
//     );
// };

// const MenuItems = ({ children, onClose, position = 'bottom' }) => {
//     const positionClasses = position === 'top'
//         ? 'bottom-full mb-2'
//         : 'top-full mt-2';

//     return (
//         <>
//             <div className="fixed inset-0 z-40" onClick={onClose} />
//             {/* <div className={`absolute right-0 z-50 ${positionClasses} w-72 origin-top-right divide-y divide-gray-100 dark:divide-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-xl ring-1 ring-black dark:ring-gray-600 ring-opacity-5 focus:outline-none border border-gray-200 dark:border-gray-600`}*/}
//             <div className={`absolute right-0 z-50 ${positionClasses} w-72 origin-top-right divide-y divide-gray-100 dark:divide-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-xl ring-1 ring-black dark:ring-gray-600 ring-opacity-5 focus:outline-none border border-gray-200 dark:border-gray-600`} style={{ maxHeight: '100px' }}>
//                 {/* <div className="py-2 max-h-80 overflow-y-auto"> */}
//                 <div className="py-2 overflow-y-auto" style={{ maxHeight: 'inherit' }}>
//                     {children}
//                 </div>
//             </div>
//         </>
//     );
// };

// const MenuItem = ({ children }) => {
//     const [active, setActive] = useState(false);

//     return (
//         <div
//             onMouseEnter={() => setActive(true)}
//             onMouseLeave={() => setActive(false)}
//         >
//             {children({ active })}
//         </div>
//     );
// };

// // Utility function for class names
// const clsx = (...classes) => {
//     return classes.filter(Boolean).join(' ');
// };

// export function PerformActions({ item, onAction }) {
//     // Theme state for light/dark mode
//     const [theme, setTheme] = useState('light');

//     // Theme detection
//     useEffect(() => {
//         const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
//         setTheme(prefersDark ? 'dark' : 'light');

//         const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
//         const handleChange = (e) => setTheme(e.matches ? 'dark' : 'light');
//         mediaQuery.addEventListener("change", handleChange);

//         return () => mediaQuery.removeEventListener("change", handleChange);
//     }, []);
//     // Define all perform actions with icons and colors
//     const performActions = [
//         {
//             label: "Upload Document",
//             action: "uploadDocument",
//             icon: DocumentArrowUpIcon,
//             color: "text-blue-600",
//             hoverColor: "hover:bg-blue-50 hover:text-blue-700"
//         },
//         {
//             label: "View Documents",
//             action: "viewDocuments",
//             icon: DocumentTextIcon,
//             color: "text-cyan-600",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-700"
//         },
//         {
//             label: "Add Crf",
//             action: "addCrf",
//             icon: PlusIcon,
//             color: "text-green-600",
//             hoverColor: "hover:bg-green-50 hover:text-green-700"
//         },
//         {
//             label: "Clone Item",
//             action: "cloneItem",
//             icon: DocumentDuplicateIcon,
//             color: "text-purple-600",
//             hoverColor: "hover:bg-purple-50 hover:text-purple-700"
//         },
//         {
//             label: "Edit Instrument Detail",
//             action: "editInstrumentDetail",
//             icon: PencilIcon,
//             color: "text-indigo-600",
//             hoverColor: "hover:bg-indigo-50 hover:text-indigo-700"
//         },
//         {
//             label: "Cancel Crf",
//             action: "cancelCrf",
//             icon: XMarkIcon,
//             color: "text-red-600",
//             hoverColor: "hover:bg-red-50 hover:text-red-700"
//         },
//         {
//             label: "Request Cancel LRN",
//             action: "requestCancelLRN",
//             icon: ExclamationTriangleIcon,
//             color: "text-red-700",
//             hoverColor: "hover:bg-red-50 hover:text-red-800"
//         },
//         {
//             label: "Request Revision",
//             action: "requestRevision",
//             icon: ArrowPathIcon,
//             color: "text-orange-600",
//             hoverColor: "hover:bg-orange-50 hover:text-orange-700"
//         },
//         {
//             label: "Edit Details for revision",
//             action: "editDetailsForRevision",
//             icon: PencilIcon,
//             color: "text-yellow-600",
//             hoverColor: "hover:bg-yellow-50 hover:text-yellow-700"
//         },
//         {
//             label: "Calibrate Step 1",
//             action: "calibrateStep1",
//             icon: WrenchScrewdriverIcon,
//             color: "text-teal-600",
//             hoverColor: "hover:bg-teal-50 hover:text-teal-700"
//         },
//         {
//             label: "Back To Step 1",
//             action: "backToStep1",
//             icon: ArrowLeftIcon,
//             color: "text-gray-600",
//             hoverColor: "hover:bg-gray-50 hover:text-gray-700"
//         },
//         {
//             label: "Calibrate Step 2",
//             action: "calibrateStep2",
//             icon: WrenchScrewdriverIcon,
//             color: "text-teal-700",
//             hoverColor: "hover:bg-teal-50 hover:text-teal-800"
//         },
//         {
//             label: "Change Master",
//             action: "changeMaster",
//             icon: Cog6ToothIcon,
//             color: "text-pink-600",
//             hoverColor: "hover:bg-pink-50 hover:text-pink-700"
//         },
//         {
//             label: "Calibrate Step 3",
//             action: "calibrateStep3",
//             icon: WrenchScrewdriverIcon,
//             color: "text-teal-800",
//             hoverColor: "hover:bg-teal-50 hover:text-teal-900"
//         },
//         {
//             label: "Edit Calib Point",
//             action: "editCalibPoint",
//             icon: PencilIcon,
//             color: "text-violet-600",
//             hoverColor: "hover:bg-violet-50 hover:text-violet-700"
//         },
//         {
//             label: "View Rawdata",
//             action: "viewRawdata",
//             icon: EyeIcon,
//             color: "text-cyan-600",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-700"
//         },
//         {
//             label: "View Tracebility",
//             action: "viewTraceability",
//             icon: DocumentMagnifyingGlassIcon,
//             color: "text-cyan-700",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-800"
//         },
//         {
//             label: "View Certificate",
//             action: "viewCertificate",
//             icon: CertificateIcon,
//             color: "text-cyan-600",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-700"
//         },
//         {
//             label: "View Certificate with l/h",
//             action: "viewCertificateWithLH",
//             icon: CertificateIcon,
//             color: "text-cyan-800",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-900"
//         },
//         {
//             label: "View CMC Calculation",
//             action: "viewCMCCalculation",
//             icon: CalculatorIcon,
//             color: "text-cyan-600",
//             hoverColor: "hover:bg-cyan-50 hover:text-cyan-700"
//         },
//         {
//             label: "Review",
//             action: "review",
//             icon: ClipboardDocumentCheckIcon,
//             color: "text-blue-700",
//             hoverColor: "hover:bg-blue-50 hover:text-blue-800"
//         },
//         {
//             label: "Approve",
//             action: "approve",
//             icon: CheckIcon,
//             color: "text-green-700",
//             hoverColor: "hover:bg-green-50 hover:text-green-800"
//         }, {
//             label: "Calculate Uncertainty",
//             action: "calculateUncertainty",
//             icon: CalculatorIcon,
//             color: "text-green-700",
//             hoverColor: "hover:bg-green-50 hover:text-green-800"
//         },
//         {
//             label: "Regenerate Cache Copy",
//             action: "regenerateCache",
//             icon: ArrowDownTrayIcon,
//             color: "text-orange-600",
//             hoverColor: "hover:bg-orange-50 hover:text-orange-700"
//         }
//     ];

//     const handleActionClick = (action) => {
//         //console.log('PerformActions: Triggering action:', action);
//         onAction(action, item);
//     };

//     return (

//         <div className={`flex justify-center ${theme === 'dark' ? 'dark' : ''}`}>
//             <Menu>
//                 <MenuButton>
//                     <EllipsisHorizontalIcon className="w-4 h-4 text-gray-600 dark:text-gray-300" />
//                 </MenuButton>

//                 <MenuItems>
//                     {performActions.map((action, index) => {
//                         const IconComponent = action.icon;
//                         return (
//                             <MenuItem key={`${action.action}-${index}`}>
//                                 {({ active }) => (
//                                     <button
//                                         onClick={() => handleActionClick(action.action)}
//                                         className={clsx(
//                                             "group flex w-full items-center px-4 py-2 text-sm font-medium transition-colors duration-150",
//                                             active
//                                                 ? action.hoverColor
//                                                 : action.color,
//                                             "hover:bg-opacity-10"
//                                         )}
//                                     >
//                                         <IconComponent className="mr-3 h-4 w-4 flex-shrink-0" />
//                                         <span className="truncate">{action.label}</span>
//                                     </button>
//                                 )}
//                             </MenuItem>
//                         );
//                     })}
//                 </MenuItems>
//             </Menu>
//         </div>
//     );
// }

// PerformActions.propTypes = {
//     item: PropTypes.object.isRequired,
//     onAction: PropTypes.func.isRequired,
// };












